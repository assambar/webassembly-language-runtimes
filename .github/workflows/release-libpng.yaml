# Note that for this workflow to be triggered, the tag needs to be
# created of the form `libs/libpng/<version>+<buildinfo>`, where <buildinfo>
# by convention is YYYYMMDD-<short-sha> (short SHA can be calculated
# with `git rev-parse --short HEAD`). An example of a tag following
# the convention that triggers automation would be
# `libs/libpng/1.2.13+20230131-8dfe8b9`.
name: Release Libpng
on:
  push:
    tags:
      - libs/libpng/*
jobs:
  release-libpng:
    strategy:
      matrix:
        include:
          - version: 1.6.39
    # Only run for the Libpng version specified in the git tag.
    #
    # This if could be moved to the parent `job` section when it's
    # supported by GitHub (https://github.com/community/community/discussions/37883)
    if: startsWith(github.event.ref, format('refs/tags/libs/libpng/{0}+', matrix.version))
    uses: ./.github/workflows/reusable-release-lib.yaml
    with:
      name: "libpng"
      version: ${{ matrix.version }}
      target-name: "libpng"
      tag-prefix: "v"
    runs-on: ubuntu-latest
